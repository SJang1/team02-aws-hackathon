<!DOCTYPE html>
<html>
<head>
    <title>ClOps - AWS 서비스 추천 플랫폼</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        
        .navbar { background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); padding: 1rem 0; box-shadow: 0 2px 20px rgba(0,0,0,0.1); position: fixed; width: 100%; top: 0; z-index: 1000; }
        .nav-container { max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; padding: 0 2rem; }
        .logo { font-size: 1.5rem; font-weight: bold; color: #333; }
        .nav-links { display: flex; list-style: none; gap: 2rem; }
        .nav-link { text-decoration: none; color: #333; font-weight: 500; transition: color 0.3s; padding: 0.5rem 1rem; border-radius: 8px; }
        .nav-link:hover, .nav-link.active { color: #667eea; background: rgba(102, 126, 234, 0.1); }
        
        .mobile-menu-btn { display: none; background: none; border: none; font-size: 1.5rem; color: #333; cursor: pointer; }
        .mobile-nav { display: none; position: absolute; top: 100%; left: 0; right: 0; background: rgba(255,255,255,0.98); backdrop-filter: blur(10px); box-shadow: 0 2px 20px rgba(0,0,0,0.1); }
        .mobile-nav.show { display: block; }
        .mobile-nav-links { list-style: none; padding: 1rem 0; }
        .mobile-nav-links li { padding: 0.5rem 2rem; }
        .mobile-nav-links .nav-link { display: block; padding: 0.75rem 0; border-radius: 0; }
        
        .tab-content { 
            display: none; 
            padding-top: 80px;
        }
        .tab-content.active { 
            display: block;
        }
        .tab-content > * {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.5s cubic-bezier(0.25, 0.1, 0.25, 1);
        }
        .tab-content.active > * {
            opacity: 1;
            transform: translateY(0);
        }
        .tab-content.fade-out > * {
            display: none;
        }
        
        .hero { text-align: center; padding: 4rem 2rem; color: white; }
        .hero h1 { font-size: 3rem; margin-bottom: 1rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .hero p { font-size: 1.2rem; max-width: 600px; margin: 0 auto; }
        .hero-subtitle { margin-top: 1rem; }
        .hero-subtitle p { font-size: 1rem; max-width: 700px; margin: 0 auto; }
        
        .features { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin: 4rem 2rem; padding: 0 2rem; }
        .feature { background: rgba(255,255,255,0.1); padding: 2rem; border-radius: 16px; text-align: center; color: white; transition: transform 0.3s ease; }
        .feature:hover { transform: translateY(-10px) scale(1.05); }
        .feature i { font-size: 3rem; margin-bottom: 1rem; }
        
        .benefits-section { background: rgba(255,255,255,0.05); margin: 4rem 2rem; padding: 3rem 2rem; border-radius: 20px; color: white; text-align: center; }
        .benefits-section h2 { font-size: 2rem; margin-bottom: 3rem; }
        .benefits-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem; }
        .benefit-card { background: rgba(255,255,255,0.1); padding: 2rem; border-radius: 16px; }
        .benefit-amount { font-size: 2.5rem; font-weight: bold; color: #4CAF50; margin: 0.5rem 0; }
        
        .service-header { text-align: center; padding: 2rem; color: white; }
        .service-header h2 { font-size: 2rem; margin-bottom: 1rem; }
        .current-plan { margin-top: 1rem; }
        .plan-badge { background: #4CAF50; color: white; padding: 0.5rem 1rem; border-radius: 20px; font-weight: bold; }
        
        .pricing-section { padding: 4rem 2rem; color: white; }
        .pricing-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; max-width: 1200px; margin: 0 auto; }
        .pricing-card { background: rgba(255,255,255,0.1); padding: 2rem; border-radius: 16px; text-align: center; position: relative; transition: all 0.3s ease; cursor: pointer; }
        .pricing-card:hover { border: 2px solid #4CAF50; transform: scale(1.05); }
        .pricing-card.selected { border: 3px solid #4CAF50; transform: scale(1.08); box-shadow: 0 0 30px rgba(76, 175, 80, 0.5); }
        
        .pricing-card.free { background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(200,200,200,0.2) 100%); }
        .pricing-card.standard { background: linear-gradient(135deg, rgba(76,175,80,0.2) 0%, rgba(139,195,74,0.3) 100%); }
        .pricing-card.pro { 
            background: linear-gradient(135deg, rgba(255,193,7,0.3) 0%, rgba(255,152,0,0.4) 25%, rgba(233,30,99,0.4) 50%, rgba(156,39,176,0.4) 75%, rgba(63,81,181,0.3) 100%);
            animation: rainbow-glow 3s ease-in-out infinite alternate;
        }
        
        @keyframes rainbow-glow {
            0% { box-shadow: 0 0 20px rgba(255,193,7,0.5); }
            25% { box-shadow: 0 0 25px rgba(255,152,0,0.6); }
            50% { box-shadow: 0 0 30px rgba(233,30,99,0.7); }
            75% { box-shadow: 0 0 25px rgba(156,39,176,0.6); }
            100% { box-shadow: 0 0 20px rgba(63,81,181,0.5); }
        }
        
        .plan-demo { position: absolute; top: -10px; right: -10px; background: #FF5722; color: white; padding: 0.3rem 0.6rem; border-radius: 12px; font-size: 0.8rem; font-weight: bold; display: none; }
        .pricing-card.selected .plan-demo { display: block; }
        
        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); }
        .modal-content { background: white; margin: 15% auto; padding: 2rem; border-radius: 16px; width: 80%; max-width: 500px; text-align: center; }
        .modal-content h3 { color: #333; margin-bottom: 1rem; }
        .modal-content p { color: #666; margin-bottom: 2rem; }
        .modal-buttons { display: flex; gap: 1rem; justify-content: center; }
        .modal-btn { padding: 0.8rem 2rem; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; transition: all 0.3s; }
        .modal-btn.confirm { background: #4CAF50; color: white; }
        .modal-btn.cancel { background: #f44336; color: white; }
        .modal-btn:hover { transform: translateY(-2px); }
        .plan-name { font-size: 1.5rem; font-weight: bold; margin-bottom: 1rem; }
        .plan-price { font-size: 2rem; margin-bottom: 1rem; }
        .plan-features { list-style: none; margin: 2rem 0; }
        .plan-features li { padding: 0.5rem 0; }
        .plan-features li.unavailable { opacity: 0.5; text-decoration: line-through; }
        
        .contact-section { padding: 4rem 2rem; color: white; }
        .contact-form { max-width: 600px; margin: 0 auto; background: rgba(255,255,255,0.1); padding: 2rem; border-radius: 16px; }
        .form-group { margin-bottom: 1.5rem; }
        label { display: block; margin-bottom: 0.5rem; font-weight: 600; }
        input, textarea, select { width: 100%; padding: 12px 16px; border: 2px solid #e1e5e9; border-radius: 12px; font-size: 1rem; background: #f8f9fa; }
        input:focus, textarea:focus, select:focus { outline: none; border-color: #667eea; background: white; }
        
        .container { max-width: 800px; margin: 0 auto; padding: 2rem; }
        .card { background: white; border-radius: 20px; padding: 3rem; box-shadow: 0 20px 40px rgba(0,0,0,0.1); margin-top: -2rem; position: relative; z-index: 1; }
        
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; }
        .form-group.full-width { grid-column: 1 / -1; }
        
        .custom-input { display: none; margin-top: 0.5rem; }
        .custom-input.show { display: block; }
        #customResourceConfig { padding: 1rem; background: #f8f9fa; border-radius: 8px; margin-top: 1rem; }
        #customResourceConfig label { margin-top: 0.5rem; margin-bottom: 0.3rem; font-size: 0.85rem; }
        #customResourceConfig input { margin-bottom: 0.5rem; }
        
        .submit-btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 16px 32px; border: none; border-radius: 12px; font-size: 1.1rem; font-weight: 600; cursor: pointer; width: 100%; transition: all 0.3s; }
        .submit-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3); }
        
        .loading { 
            margin-top: 2rem; 
            padding: 2rem; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            border-radius: 16px; 
            color: white; 
            display: none; 
            text-align: center;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.5s cubic-bezier(0.25, 0.1, 0.25, 1);
        }
        .loading.show {
            opacity: 1;
            transform: translateY(0);
        }
        .result { 
            margin-top: 2rem; 
            padding: 2rem; 
            border-radius: 16px; 
            color: white; 
            display: none;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.5s cubic-bezier(0.25, 0.1, 0.25, 1);
        }
        .result.show {
            opacity: 1;
            transform: translateY(0);
        }
        .result.success { background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%); }
        .result.error { background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%); }
        .architecture-diagram {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
            margin: 2rem 0;
        }
        .service-layer {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            flex-wrap: wrap;
        }
        .service-stack {
            position: relative;
            display: inline-block;
            cursor: pointer;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.5s cubic-bezier(0.25, 0.1, 0.25, 1);
        }
        .service-stack.show {
            opacity: 1;
            transform: translateY(0);
        }
        .service-stack:hover .main-block {
            background: rgba(255,255,255,0.25);
            border-color: #4CAF50;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(76, 175, 80, 0.3);
        }
        .service-block {
            background: rgba(255,255,255,0.15);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
            min-width: 150px;
        }
        .main-block {
            position: relative;
            z-index: 3;
        }
        .shadow-block {
            position: absolute;
            top: 4px;
            left: 4px;
            right: -4px;
            bottom: -4px;
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.2);
            z-index: 2;
        }
        .shadow-block-2 {
            position: absolute;
            top: 8px;
            left: 8px;
            right: -8px;
            bottom: -8px;
            background: rgba(255,255,255,0.04);
            border: 1px solid rgba(255,255,255,0.1);
            z-index: 1;
        }
        .service-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            color: #4CAF50;
        }
        .service-name {
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        .service-type {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 0.5rem;
        }
        .service-cost {
            font-size: 0.85rem;
            color: #FFD700;
        }
        .service-quantity {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #FF5722;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
            border: 2px solid white;
            z-index: 4;
        }
        .connection-arrow {
            font-size: 1.5rem;
            color: rgba(255,255,255,0.6);
            margin: 0 1rem;
        }
        .layer-label {
            font-size: 0.9rem;
            opacity: 0.7;
            margin-bottom: 1rem;
        }
        .cost-summary { 
            background: rgba(255,255,255,0.2); 
            padding: 1rem; 
            border-radius: 8px; 
            margin-top: 1rem;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.5s cubic-bezier(0.25, 0.1, 0.25, 1);
        }
        .cost-summary.show {
            opacity: 1;
            transform: translateY(0);
        }
        .spinner { border: 4px solid rgba(255,255,255,0.3); border-top: 4px solid white; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin: 0 auto 1rem; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .service-options { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem; }
        .option-card { background: rgba(255,255,255,0.1); padding: 2rem; border-radius: 16px; text-align: center; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; }
        .option-card:hover { background: rgba(255,255,255,0.2); transform: translateY(-5px); }
        .option-card.active { border-color: #4CAF50; background: rgba(76, 175, 80, 0.2); }
        .option-card i { font-size: 3rem; color: #4CAF50; margin-bottom: 1rem; }
        .option-card h3 { color: white; margin-bottom: 0.5rem; }
        .option-card p { color: rgba(255,255,255,0.8); font-size: 0.9rem; }
        
        .uuid-display { margin-top: 1rem; padding: 1rem; background: rgba(255,255,255,0.1); border-radius: 8px; }
        .uuid-container label { display: block; margin-bottom: 0.5rem; font-weight: bold; }
        .uuid-copy-section { display: flex; gap: 0.5rem; }
        .uuid-copy-section input { flex: 1; padding: 0.5rem; border: 1px solid rgba(255,255,255,0.3); border-radius: 4px; background: rgba(255,255,255,0.1); color: white; }
        .copy-btn { padding: 0.5rem 1rem; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; transition: background 0.3s; }
        .copy-btn:hover { background: #45a049; }
        .copy-btn.copied { background: #2196F3; }
        
        @media (max-width: 768px) {
            .form-grid { grid-template-columns: 1fr; }
            .hero h1 { font-size: 2rem; }
            .nav-links { display: none; }
            .mobile-menu-btn { display: block; }
            .pricing-grid { grid-template-columns: 1fr; }
            .benefits-grid { grid-template-columns: 1fr; }
            .service-options { grid-template-columns: 1fr; }
            .nav-container { padding: 0 1rem; }
            .hero { padding: 2rem 1rem; }
            .container { padding: 1rem; }
            .card { padding: 2rem 1rem; }
            .uuid-copy-section { flex-direction: column; }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo"><i class="fas fa-cloud"></i> ClOps</div>
            <ul class="nav-links">
                <li><a href="#" onclick="showTab('home')" class="nav-link active">홈</a></li>
                <li><a href="#" onclick="showTab('service')" class="nav-link">서비스</a></li>
                <li><a href="#" onclick="showTab('pricing')" class="nav-link">요금제</a></li>
                <li><a href="#" onclick="showTab('contact')" class="nav-link">문의</a></li>
            </ul>
            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        <div id="mobile-nav" class="mobile-nav">
            <ul class="mobile-nav-links">
                <li><a href="#" onclick="showTab('home'); closeMobileMenu()" class="nav-link active">홈</a></li>
                <li><a href="#" onclick="showTab('service'); closeMobileMenu()" class="nav-link">서비스</a></li>
                <li><a href="#" onclick="showTab('pricing'); closeMobileMenu()" class="nav-link">요금제</a></li>
                <li><a href="#" onclick="showTab('contact'); closeMobileMenu()" class="nav-link">문의</a></li>
            </ul>
        </div>
    </nav>
    
    <!-- 홈 탭 -->
    <div id="home-tab" class="tab-content active">
        <section class="hero">
            <h1><i class="fas fa-magic"></i> ClOps</h1>
            <p>인디 개발자와 소규모 팀을 위한 AI 기반 AWS 아키텍처 추천 및 컨설팅 플랫폼</p>
            <div class="hero-subtitle">
                <p>갑작스러운 트래픽 급증에도 다운타임 없는 확장 가능한 인프라를 자동으로 설계해드립니다</p>
            </div>
        </section>
        
        <div class="features">
            <div class="feature">
                <i class="fas fa-shield-alt"></i>
                <h3>실패 방지</h3>
                <p>바이럴 성공 시점에 발생하는 치명적인 서버 다운을 선제적으로 방지</p>
            </div>
            <div class="feature">
                <i class="fas fa-expand-arrows-alt"></i>
                <h3>자동 확장</h3>
                <p>Auto Scaling과 Load Balancing이 포함된 확장 가능한 아키텍처 자동 설계</p>
            </div>
            <div class="feature">
                <i class="fas fa-brain"></i>
                <h3>AI 전문가</h3>
                <p>전문 DevOps 인력의 역할을 수행하여 비싼 전문성 격차 해소</p>
            </div>
        </div>
        
        <div class="benefits-section">
            <h2><i class="fas fa-trophy"></i> ClOps 사용의 이점</h2>
            <div class="benefits-grid">
                <div class="benefit-card">
                    <h3>비용 절약</h3>
                    <p class="benefit-amount">$32,000+</p>
                    <p>IaC 학습 비용 절약</p>
                </div>
                <div class="benefit-card">
                    <h3>다운타임 방지</h3>
                    <p class="benefit-amount">$50,000+</p>
                    <p>서버 다운 손실 예방</p>
                </div>
                <div class="benefit-card">
                    <h3>ROI</h3>
                    <p class="benefit-amount">477%</p>
                    <p>연간 투자 수익률</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 서비스 탭 -->
    <div id="service-tab" class="tab-content">
        <div class="service-header">
            <h2><i class="fas fa-cogs"></i> AWS 서비스 추천</h2>
            <div class="current-plan">
                <span class="plan-badge">Free 요금제</span>
            </div>
        </div>
        
        <div class="container">
            <!-- 서비스 선택 옵션 -->
            <div class="service-options">
                <div class="option-card active" onclick="selectServiceOption('new')">
                    <i class="fas fa-plus-circle"></i>
                    <h3>새로운 분석</h3>
                    <p>새로운 AWS 서비스 분석을 시작합니다</p>
                </div>
                <div class="option-card" onclick="selectServiceOption('load')">
                    <i class="fas fa-history"></i>
                    <h3>기존 분석 불러오기</h3>
                    <p>UUID로 이전 분석 결과를 불러옵니다</p>
                </div>
            </div>
            
            <!-- UUID 입력 폼 -->
            <div id="uuid-form" class="card" style="display: none;">
                <h3><i class="fas fa-search"></i> 분석 결과 불러오기</h3>
                <div class="form-group">
                    <label for="analysisUuid">분석 UUID:</label>
                    <input type="text" id="analysisUuid" placeholder="분석 UUID를 입력하세요" required>
                </div>
                <button type="button" class="submit-btn" onclick="loadAnalysis()">
                    <i class="fas fa-download"></i> 분석 결과 불러오기
                </button>
            </div>
            
            <!-- 새로운 분석 폼 -->
            <div id="new-analysis-form" class="card">
                <form id="estimateForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="serviceType">서비스 유형:</label>
                            <select id="serviceType" required>
                                <option value="">선택하세요</option>
                                <option value="인디 게임">인디 게임</option>
                                <option value="웹사이트/웹앱">웹사이트/웹앱</option>
                                <option value="API 서버">API 서버</option>
                                <option value="모바일 앱 백엔드">모바일 앱 백엔드</option>
                                <option value="데이터 분석">데이터 분석</option>
                                <option value="머신러닝/AI">머신러닝/AI</option>
                                <option value="기타">기타</option>
                            </select>
                            <input type="text" id="customServiceType" class="custom-input" placeholder="서비스 유형을 직접 입력하세요">
                        </div>
                        
                        <div class="form-group">
                            <label for="expectedUsers">예상 사용자 수:</label>
                            <select id="expectedUsers" required>
                                <option value="">선택하세요</option>
                                <option value="소규모 (1-100명)">소규모 (1-100명)</option>
                                <option value="중간규모 (100-1,000명)">중간규모 (100-1,000명)</option>
                                <option value="대규모 (1,000-10,000명)">대규모 (1,000-10,000명)</option>
                                <option value="엔터프라이즈 (10,000명+)">엔터프라이즈 (10,000명+)</option>
                                <option value="기타">기타</option>
                            </select>
                            <input type="text" id="customExpectedUsers" class="custom-input" placeholder="사용자 수를 직접 입력하세요">
                        </div>
                        
                        <div class="form-group">
                            <label for="resourceAllocation">사용자당 리소스 할당:</label>
                            <select id="resourceAllocation" required>
                                <option value="권장 자동 할당" selected>권장 자동 할당 (AI 추천)</option>
                                <option value="사용자 지정">사용자 직접 설정</option>
                            </select>
                            <div id="customResourceConfig" class="custom-input">
                                <label for="cpuPerUser">CPU (GHz/사용자):</label>
                                <input type="number" id="cpuPerUser" step="0.1" min="0.1" placeholder="1.0">
                                <label for="memoryPerUser">메모리 (GB/사용자):</label>
                                <input type="number" id="memoryPerUser" step="0.1" min="0.1" placeholder="1.0">
                                <label for="storagePerUser">스토리지 (GB/사용자):</label>
                                <input type="number" id="storagePerUser" step="1" min="1" placeholder="10">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="region">AWS 리전:</label>
                            <select id="region" required>
                                <option value="ap-northeast-2" selected>서울 (ap-northeast-2)</option>
                                <option value="us-east-1">버지니아 북부 (us-east-1)</option>
                                <option value="us-west-2">오레곤 (us-west-2)</option>
                                <option value="ap-southeast-1">싱가포르 (ap-southeast-1)</option>
                                <option value="global-average">전체 리전 평균</option>
                                <option value="기타">기타</option>
                            </select>
                            <input type="text" id="customRegion" class="custom-input" placeholder="리전을 직접 입력하세요">
                        </div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="additionalInfo">추가 요구사항:</label>
                        <textarea id="additionalInfo" rows="3" placeholder="특별한 요구사항이나 기능을 입력하세요 (선택사항)"></textarea>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="budget"><i class="fas fa-dollar-sign"></i> 월 예산 (USD):</label>
                        <input type="number" id="budget" min="1" placeholder="100" required>
                    </div>
                    
                    <button type="submit" class="submit-btn">
                        <i class="fas fa-magic"></i> AWS 서비스 추천 받기
                    </button>
                </form>
                
                <div id="loading" class="loading">
                    <div class="spinner"></div>
                    <h3><i class="fas fa-robot"></i> AI가 분석 중입니다...</h3>
                    <p id="loading-tip">최적의 AWS 서비스 구성을 찾고 있습니다. 잠시만 기다려주세요.</p>
                </div>
                
                <div id="result" class="result">
                    <div id="result-content"></div>
                    <div id="uuid-display" class="uuid-display" style="display: none;">
                        <div class="uuid-container">
                            <label>분석 UUID (나중에 불러오기 용):</label>
                            <div class="uuid-copy-section">
                                <input type="text" id="current-uuid" readonly>
                                <button type="button" class="copy-btn" onclick="copyUuid()">
                                    <i class="fas fa-copy"></i> 복사
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 요금제 탭 -->
    <div id="pricing-tab" class="tab-content">
        <div class="pricing-section">
            <h2 style="text-align: center; color: white; margin-bottom: 3rem;"><i class="fas fa-credit-card"></i> 요금제</h2>
            <div class="pricing-grid">
                <div class="pricing-card free" onclick="selectPlan('free', 'Free', '$0')">
                    <div class="plan-demo">DEMO</div>
                    <div class="plan-name">Free</div>
                    <div class="plan-price">$0<span style="font-size: 1rem;">/월</span></div>
                    <ul class="plan-features">
                        <li><i class="fas fa-check"></i> 기본 요금제 예측</li>
                        <li><i class="fas fa-check"></i> AI 기반 서비스 추천</li>
                        <li><i class="fas fa-check"></i> 월 5회 분석</li>
                        <li class="unavailable"><i class="fas fa-times"></i> 사용량 측정 보고서</li>
                        <li class="unavailable"><i class="fas fa-times"></i> 우선 지원</li>
                    </ul>
                </div>
                
                <div class="pricing-card pro" onclick="selectPlan('pro', 'Pro', '$29')">
                    <div class="plan-demo">DEMO</div>
                    <div class="plan-name">Pro</div>
                    <div class="plan-price">$29<span style="font-size: 1rem;">/월</span></div>
                    <ul class="plan-features">
                        <li><i class="fas fa-check"></i> 모든 Free 기능</li>
                        <li><i class="fas fa-check"></i> 사용량 측정 및 분석</li>
                        <li><i class="fas fa-check"></i> 상세 보고서 제작</li>
                        <li><i class="fas fa-check"></i> 월 50회 분석</li>
                        <li><i class="fas fa-check"></i> 우선 지원</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 문의 탭 -->
    <div id="contact-tab" class="tab-content">
        <div class="contact-section">
            <h2 style="text-align: center; margin-bottom: 3rem;"><i class="fas fa-envelope"></i> 문의하기</h2>
            <div class="contact-form">
                <form id="contactForm">
                    <div class="form-group">
                        <label for="contactName">이름:</label>
                        <input type="text" id="contactName" required>
                    </div>
                    <div class="form-group">
                        <label for="contactEmail">이메일:</label>
                        <input type="email" id="contactEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="contactSubject">문의 유형:</label>
                        <select id="contactSubject" required>
                            <option value="">선택하세요</option>
                            <option value="일반 문의">일반 문의</option>
                            <option value="기술 지원">기술 지원</option>
                            <option value="요금제 문의">요금제 문의</option>
                            <option value="파트너십">파트너십</option>
                            <option value="기타">기타</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="contactMessage">메시지:</label>
                        <textarea id="contactMessage" rows="5" required placeholder="문의 내용을 자세히 적어주세요"></textarea>
                    </div>
                    <button type="submit" class="submit-btn">
                        <i class="fas fa-paper-plane"></i> 문의 보내기
                    </button>
                </form>
            </div>
        </div>
    </div>
    
    <!-- 요금제 변경 모달 -->
    <div id="planModal" class="modal">
        <div class="modal-content">
            <h3>요금제 변경</h3>
            <p id="planModalText"></p>
            <div class="modal-buttons">
                <button class="modal-btn confirm" onclick="confirmPlanChange()">변경</button>
                <button class="modal-btn cancel" onclick="closePlanModal()">취소</button>
            </div>
        </div>
    </div>
    
    <!-- 서비스 정보 모달 -->
    <div id="serviceModal" class="modal">
        <div class="modal-content">
            <h3 id="serviceModalTitle"></h3>
            <p id="serviceModalText"></p>
            <div class="modal-buttons">
                <button class="modal-btn confirm" onclick="closeServiceModal()">확인</button>
            </div>
        </div>
    </div>

    <script>
        // 랜덤 팁 배열
        const loadingTips = [
            '팁: Auto Scaling을 사용하면 트래픽 급증 시 자동으로 서버가 확장됩니다.',
            '팁: 인디 게임 데이브 더 다이버는 초기 100명에서 300만명으로 성장했습니다.',
            '팁: AWS Lambda를 사용하면 서버 관리 없이 코드만 실행할 수 있습니다.',
            '팁: RDS Multi-AZ를 사용하면 데이터베이스 장애 시 자동 복구됩니다.',
            '팁: CloudFront CDN을 사용하면 전 세계 사용자에게 빠른 속도를 제공합니다.',
            '팁: 서버 다운타임 1시간이 평균 $50,000의 손실을 발생시킵니다.',
            '팁: t2.micro 인스턴스는 AWS 프리티어에서 1년간 무료로 사용 가능합니다.',
            '팁: 예약 인스턴스를 사용하면 최대 75%까지 비용을 절약할 수 있습니다.',
            '팁: S3 Intelligent Tiering을 사용하면 자동으로 저장 비용이 최적화됩니다.',
            '팁: 로드 밸런서를 사용하면 서버 장애 시에도 서비스가 지속됩니다.',
            '팁: 모니터링을 설정하면 문제 발생 전에 미리 알림을 받을 수 있습니다.',
            '팁: 인디 게임 스컷은 첫 달에 100만 다운로드를 달성했습니다.'
        ];
        
        let tipInterval;
        let currentPlan = 'free';
        let selectedPlan = null;
        let currentUuid = null;
        let currentServiceOption = 'new';
        
        // 요금제 선택 함수
        function selectPlan(planType, planName, planPrice) {
            selectedPlan = { type: planType, name: planName, price: planPrice };
            
            // 모달 텍스트 설정
            const modalText = document.getElementById('planModalText');
            modalText.innerHTML = `<strong>${planName}</strong> 요금제(${planPrice}/월)로 변경하시겠습니까?<br><small>이는 데모 버전입니다.</small>`;
            
            // 모달 표시
            document.getElementById('planModal').style.display = 'block';
        }
        
        // 요금제 변경 확인
        function confirmPlanChange() {
            if (selectedPlan) {
                // 기존 선택 제거
                document.querySelectorAll('.pricing-card').forEach(card => {
                    card.classList.remove('selected');
                });
                
                // 새 요금제 선택
                document.querySelector(`.pricing-card.${selectedPlan.type}`).classList.add('selected');
                
                // 서비스 탭의 요금제 배지 업데이트
                const planBadge = document.querySelector('.plan-badge');
                planBadge.textContent = `${selectedPlan.name} 요금제`;
                planBadge.style.background = selectedPlan.type === 'free' ? '#4CAF50' : 
                                           'linear-gradient(45deg, #FF6B6B, #4ECDC4, #45B7D1, #96CEB4, #FFEAA7)';
                
                currentPlan = selectedPlan.type;
                
                alert(`${selectedPlan.name} 요금제로 변경되었습니다! (데모)`);
            }
            closePlanModal();
        }
        
        // 모달 닫기
        function closePlanModal() {
            document.getElementById('planModal').style.display = 'none';
            selectedPlan = null;
        }
        
        // 모달 외부 클릭 시 닫기
        window.onclick = function(event) {
            const planModal = document.getElementById('planModal');
            const serviceModal = document.getElementById('serviceModal');
            if (event.target === planModal) {
                closePlanModal();
            } else if (event.target === serviceModal) {
                closeServiceModal();
            }
        }
        
        // 랜덤 팁 표시 함수
        function showRandomTip() {
            const tipElement = document.getElementById('loading-tip');
            if (tipElement) {
                const randomTip = loadingTips[Math.floor(Math.random() * loadingTips.length)];
                tipElement.textContent = randomTip;
            }
        }
        
        // 모바일 메뉴 토글
        function toggleMobileMenu() {
            const mobileNav = document.getElementById('mobile-nav');
            mobileNav.classList.toggle('show');
        }
        
        // 모바일 메뉴 닫기
        function closeMobileMenu() {
            const mobileNav = document.getElementById('mobile-nav');
            mobileNav.classList.remove('show');
        }
        
        // 탭 전환 함수 (즉시 사라짐, 부드러운 등장)
        function showTab(tabName) {
            const currentTab = document.querySelector('.tab-content.active');
            const newTab = document.getElementById(tabName + '-tab');
            
            if (currentTab === newTab) return;
            
            // 현재 탭 즉시 사라짐
            if (currentTab) {
                currentTab.classList.remove('active');
            }
            
            // 네비게이션 업데이트
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            document.querySelectorAll(`[onclick*="showTab('${tabName}')"]`).forEach(link => {
                link.classList.add('active');
            });
            
            // 새 탭 표시 및 순차적 애니메이션
            newTab.classList.add('active');
            
            const elements = newTab.children;
            Array.from(elements).forEach((element, index) => {
                element.style.transitionDelay = `${index * 0.1}s`;
            });
            
            // 애니메이션 완료 후 딜레이 리셋
            setTimeout(() => {
                Array.from(elements).forEach(element => {
                    element.style.transitionDelay = '0s';
                });
            }, elements.length * 100 + 500);
        }
        
        // 커스텀 입력 토글 함수
        function toggleCustomInput(selectId, customInputId) {
            const select = document.getElementById(selectId);
            const customInput = document.getElementById(customInputId);
            
            select.addEventListener('change', function() {
                if (this.value === '기타') {
                    customInput.classList.add('show');
                    customInput.required = true;
                } else {
                    customInput.classList.remove('show');
                    customInput.required = false;
                    customInput.value = '';
                }
            });
        }
        
        // 커스텀 입력 기능 활성화
        toggleCustomInput('serviceType', 'customServiceType');
        toggleCustomInput('expectedUsers', 'customExpectedUsers');
        toggleCustomInput('region', 'customRegion');
        
        // 리소스 할당 옵션 처리
        document.getElementById('resourceAllocation').addEventListener('change', function() {
            const customConfig = document.getElementById('customResourceConfig');
            if (this.value === '사용자 지정') {
                customConfig.classList.add('show');
                document.getElementById('cpuPerUser').required = true;
                document.getElementById('memoryPerUser').required = true;
                document.getElementById('storagePerUser').required = true;
            } else {
                customConfig.classList.remove('show');
                document.getElementById('cpuPerUser').required = false;
                document.getElementById('memoryPerUser').required = false;
                document.getElementById('storagePerUser').required = false;
            }
        });
        
        // 서비스 옵션 선택
        function selectServiceOption(option) {
            currentServiceOption = option;
            
            // 옵션 카드 활성화 상태 변경
            document.querySelectorAll('.option-card').forEach(card => {
                card.classList.remove('active');
            });
            event.target.closest('.option-card').classList.add('active');
            
            // 폼 표시/숨김
            const uuidForm = document.getElementById('uuid-form');
            const newAnalysisForm = document.getElementById('new-analysis-form');
            const result = document.getElementById('result');
            
            if (option === 'load') {
                uuidForm.style.display = 'block';
                newAnalysisForm.style.display = 'none';
                result.style.display = 'none';
                result.classList.remove('show');
            } else {
                uuidForm.style.display = 'none';
                newAnalysisForm.style.display = 'block';
                result.style.display = 'none';
                result.classList.remove('show');
            }
        }
        
        // UUID 복사 기능
        function copyUuid() {
            const uuidInput = document.getElementById('current-uuid');
            const copyBtn = document.querySelector('.copy-btn');
            
            uuidInput.select();
            document.execCommand('copy');
            
            // 버튼 상태 변경
            copyBtn.classList.add('copied');
            copyBtn.innerHTML = '<i class="fas fa-check"></i> 복사됨';
            
            setTimeout(() => {
                copyBtn.classList.remove('copied');
                copyBtn.innerHTML = '<i class="fas fa-copy"></i> 복사';
            }, 2000);
        }
        
        // 기존 분석 불러오기
        async function loadAnalysis() {
            const uuid = document.getElementById('analysisUuid').value.trim();
            const loadBtn = document.querySelector('#uuid-form .submit-btn');
            
            if (!uuid) {
                alert('UUID를 입력해주세요.');
                return;
            }
            
            // 이미 처리 중인 경우 경고
            if (loadBtn.disabled) {
                alert('분석 결과를 불러오는 중입니다. 잠시만 기다려주세요.');
                return;
            }
            
            disableSubmitButton();
            showLoading();
            
            try {
                const response = await fetch(`/status/${uuid}`);
                const data = await response.json();
                
                if (data.status === 'completed' && data.response_data) {
                    currentUuid = uuid;
                    displayAnalysisResult(data.response_data);
                } else if (data.status === 'not_found') {
                    showError('해당 UUID의 분석 결과를 찾을 수 없습니다.');
                } else if (data.status === 'processing') {
                    showError('분석이 아직 진행 중입니다. 잠시 후 다시 시도해주세요.');
                } else {
                    showError('분석 결과를 불러올 수 없습니다.');
                }
            } catch (error) {
                showError('분석 결과를 불러오는 중 오류가 발생했습니다.');
            } finally {
                enableSubmitButton();
            }
        }
        
        // 분석 결과 표시 함수
        function displayAnalysisResult(responseData) {
            if (responseData.feasible) {
                let content = '<h3><i class="fas fa-check-circle"></i> 분석 완료!</h3>';
                content += generateArchitectureDiagram(responseData.services);
                content += `<div class="cost-summary">`;
                content += `<h4><i class="fas fa-calculator"></i> 비용 요약</h4>`;
                content += `<p><strong>총 비용: $${responseData.total_cost.toFixed(2)}/월</strong></p>`;
                content += `<p><strong>예산: $${responseData.budget.toFixed(2)}/월</strong></p>`;
                content += `<p><strong>예산 활용률: ${responseData.budget_utilization.toFixed(1)}%</strong></p>`;
                content += `<p style="color: #4CAF50;"><strong>절약 금액: $${responseData.savings.toFixed(2)}/월</strong></p>`;
                
                if (responseData.cost_breakdown) {
                    content += `<div style="margin-top: 1rem; padding: 1rem; background: rgba(255,255,255,0.1); border-radius: 8px;">`;
                    content += `<h5>비용 분석</h5>`;
                    content += `<p>• 컴퓨팅: $${responseData.cost_breakdown.compute.toFixed(2)}</p>`;
                    content += `<p>• 스토리지: $${responseData.cost_breakdown.storage.toFixed(2)}</p>`;
                    content += `<p>• 네트워킹: $${responseData.cost_breakdown.networking.toFixed(2)}</p>`;
                    content += `<p>• 기타: $${responseData.cost_breakdown.other.toFixed(2)}</p>`;
                    content += `</div>`;
                }
                
                content += `</div>`;
                showResult(content, true);
            } else {
                showResult(`<h3><i class="fas fa-exclamation-triangle"></i> 예산 부족</h3><p>${responseData.message}</p>`, false);
            }
            
            // UUID 표시
            if (currentUuid) {
                document.getElementById('current-uuid').value = currentUuid;
                document.getElementById('uuid-display').style.display = 'block';
            }
        }
        
        // 버튼 비활성화 함수
        function disableSubmitButton() {
            const submitBtn = document.querySelector('#estimateForm .submit-btn');
            const loadBtn = document.querySelector('#uuid-form .submit-btn');
            
            if (submitBtn) {
                submitBtn.disabled = true;
                submitBtn.style.opacity = '0.6';
                submitBtn.style.cursor = 'not-allowed';
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> 분석 중...';
            }
            
            if (loadBtn) {
                loadBtn.disabled = true;
                loadBtn.style.opacity = '0.6';
                loadBtn.style.cursor = 'not-allowed';
            }
        }
        
        // 버튼 활성화 함수
        function enableSubmitButton() {
            const submitBtn = document.querySelector('#estimateForm .submit-btn');
            const loadBtn = document.querySelector('#uuid-form .submit-btn');
            
            if (submitBtn) {
                submitBtn.disabled = false;
                submitBtn.style.opacity = '1';
                submitBtn.style.cursor = 'pointer';
                submitBtn.innerHTML = '<i class="fas fa-magic"></i> AWS 서비스 추천 받기';
            }
            
            if (loadBtn) {
                loadBtn.disabled = false;
                loadBtn.style.opacity = '1';
                loadBtn.style.cursor = 'pointer';
            }
        }
        
        // 서비스 폼 제출
        document.getElementById('estimateForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const submitBtn = document.querySelector('#estimateForm .submit-btn');
            
            // 이미 처리 중인 경우 경고
            if (submitBtn.disabled) {
                alert('분석이 진행 중입니다. 잠시만 기다려주세요.');
                return;
            }
            
            const serviceType = document.getElementById('serviceType').value === '기타' ? 
                document.getElementById('customServiceType').value : document.getElementById('serviceType').value;
            const expectedUsers = document.getElementById('expectedUsers').value === '기타' ? 
                document.getElementById('customExpectedUsers').value : document.getElementById('expectedUsers').value;
            
            const resourceAllocation = document.getElementById('resourceAllocation').value;
            let resourceConfig = {};
            if (resourceAllocation === '사용자 지정') {
                resourceConfig = {
                    type: 'custom',
                    cpuPerUser: parseFloat(document.getElementById('cpuPerUser').value),
                    memoryPerUser: parseFloat(document.getElementById('memoryPerUser').value),
                    storagePerUser: parseInt(document.getElementById('storagePerUser').value)
                };
            } else {
                resourceConfig = { type: 'auto' };
            }
            
            const region = document.getElementById('region').value === '기타' ? 
                document.getElementById('customRegion').value : document.getElementById('region').value;
            const additionalInfo = document.getElementById('additionalInfo').value;
            const budget = document.getElementById('budget').value;
            
            // 버튼 비활성화
            disableSubmitButton();
            showLoading();
            
            try {
                const response = await fetch('/optimize', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        service_type: serviceType,
                        users: expectedUsers,
                        resource_config: resourceConfig,
                        additional_info: additionalInfo || '',
                        budget: parseInt(budget),
                        region: region 
                    })
                });
                
                const data = await response.json();
                
                if (data.error) {
                    showError(`오류: ${data.error}`);
                    enableSubmitButton();
                    return;
                }
                
                const uuid = data.uuid;
                if (!uuid) {
                    showError('UUID를 받지 못했습니다.');
                    enableSubmitButton();
                    return;
                }
                
                currentUuid = uuid;
                pollResult(uuid);
            } catch (error) {
                showError('오류가 발생했습니다.');
                enableSubmitButton();
            }
        });
        
        // 문의 폼 제출
        document.getElementById('contactForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const contactData = {
                name: document.getElementById('contactName').value,
                email: document.getElementById('contactEmail').value,
                subject: document.getElementById('contactSubject').value,
                message: document.getElementById('contactMessage').value,
                timestamp: new Date().toISOString()
            };
            
            try {
                const response = await fetch('/contact', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(contactData)
                });
                
                if (response.ok) {
                    alert('문의가 성공적으로 전송되었습니다!');
                    document.getElementById('contactForm').reset();
                } else {
                    alert('문의 전송에 실패했습니다. 다시 시도해주세요.');
                }
            } catch (error) {
                alert('문의 전송 중 오류가 발생했습니다.');
            }
        });
        
        function showLoading() {
            const loading = document.getElementById('loading');
            const result = document.getElementById('result');
            
            result.style.display = 'none';
            result.classList.remove('show');
            
            loading.style.display = 'block';
            setTimeout(() => loading.classList.add('show'), 50);
            
            // 팁 로테이션 시작
            showRandomTip();
            tipInterval = setInterval(showRandomTip, 3000);
        }
        
        function showResult(content, isSuccess = true) {
            if (tipInterval) {
                clearInterval(tipInterval);
            }
            
            const loading = document.getElementById('loading');
            const resultDiv = document.getElementById('result');
            
            // 로딩 숨기기
            loading.classList.remove('show');
            setTimeout(() => loading.style.display = 'none', 300);
            
            // 결과 표시
            resultDiv.className = isSuccess ? 'result success' : 'result error';
            resultDiv.style.display = 'block';
            document.getElementById('result-content').innerHTML = content;
            
            setTimeout(() => {
                resultDiv.classList.add('show');
                
                // 서비스 스택들 순차 애니메이션
                const serviceStacks = resultDiv.querySelectorAll('.service-stack');
                serviceStacks.forEach((stack, index) => {
                    setTimeout(() => stack.classList.add('show'), index * 150);
                });
                
                // 비용 요약 애니메이션
                const costSummary = resultDiv.querySelector('.cost-summary');
                if (costSummary) {
                    setTimeout(() => costSummary.classList.add('show'), serviceStacks.length * 150 + 200);
                }
                
                // UUID 표시
                if (currentUuid) {
                    document.getElementById('current-uuid').value = currentUuid;
                    document.getElementById('uuid-display').style.display = 'block';
                }
            }, 400);
        }
        
        function showError(message) {
            showResult(`<h3><i class="fas fa-exclamation-triangle"></i> 오류</h3><p>${message}</p>`, false);
            enableSubmitButton();
        }
        
        async function pollResult(uuid) {
            if (!uuid || uuid === 'undefined') {
                showError('잘못된 UUID입니다.');
                return;
            }
            
            try {
                const response = await fetch(`/status/${uuid}`);
                const data = await response.json();
                
                if (data.status === 'completed') {
                    displayAnalysisResult(data.response_data);
                    enableSubmitButton();
                } else if (data.status === 'failed') {
                    showError('처리 실패');
                    enableSubmitButton();
                } else {
                    setTimeout(() => pollResult(uuid), 2000);
                }
            } catch (error) {
                showError('폴링 오류');
                enableSubmitButton();
            }
        }
        
        // AWS 서비스 링크 매핑
        const awsServiceLinks = {
            'EC2': 'https://aws.amazon.com/ec2/',
            'RDS': 'https://aws.amazon.com/rds/',
            'S3': 'https://aws.amazon.com/s3/',
            'Lambda': 'https://aws.amazon.com/lambda/',
            'ALB': 'https://aws.amazon.com/elasticloadbalancing/',
            'CloudFront': 'https://aws.amazon.com/cloudfront/',
            'SageMaker': 'https://aws.amazon.com/sagemaker/',
            'DynamoDB': 'https://aws.amazon.com/dynamodb/',
            'ElastiCache': 'https://aws.amazon.com/elasticache/',
            'VPC': 'https://aws.amazon.com/vpc/',
            'WAF': 'https://aws.amazon.com/waf/',
            'CloudWatch': 'https://aws.amazon.com/cloudwatch/'
        };
        
        // 서비스 아이콘 매핑
        const serviceIcons = {
            'EC2': 'fas fa-server',
            'RDS': 'fas fa-database',
            'S3': 'fas fa-hdd',
            'Lambda': 'fas fa-bolt',
            'ALB': 'fas fa-balance-scale',
            'CloudFront': 'fas fa-globe',
            'SageMaker': 'fas fa-brain',
            'DynamoDB': 'fas fa-table',
            'ElastiCache': 'fas fa-memory',
            'VPC': 'fas fa-network-wired',
            'WAF': 'fas fa-shield-alt',
            'CloudWatch': 'fas fa-chart-line'
        };
        
        // 아키텍처 다이어그램 생성 함수
        function generateArchitectureDiagram(services) {
            // 서비스를 레이어별로 분류
            const layers = {
                'frontend': [],
                'compute': [],
                'database': [],
                'storage': [],
                'network': [],
                'uncategorized': []
            };
            
            services.forEach(service => {
                const serviceName = service.name.replace('Amazon', '').replace('AWS', '');
                if (['CloudFront', 'ALB', 'WAF'].includes(serviceName)) {
                    layers.network.push(service);
                } else if (['EC2', 'Lambda', 'SageMaker'].includes(serviceName)) {
                    layers.compute.push(service);
                } else if (['RDS', 'DynamoDB', 'ElastiCache'].includes(serviceName)) {
                    layers.database.push(service);
                } else if (['S3'].includes(serviceName)) {
                    layers.storage.push(service);
                } else if (['CloudWatch'].includes(serviceName)) {
                    layers.network.push(service);
                } else {
                    layers.uncategorized.push(service);
                }
            });
            
            let diagram = '<div class="architecture-diagram">';
            
            // 네트워크 레이어
            if (layers.network.length > 0) {
                diagram += '<div class="layer-label">네트워크 레이어</div>';
                diagram += '<div class="service-layer">';
                layers.network.forEach(service => {
                    diagram += generateServiceBlock(service);
                });
                diagram += '</div>';
                diagram += '<div class="connection-arrow"><i class="fas fa-arrow-down"></i></div>';
            }
            
            // 컴퓨트 레이어
            if (layers.compute.length > 0) {
                diagram += '<div class="layer-label">컴퓨트 레이어</div>';
                diagram += '<div class="service-layer">';
                layers.compute.forEach(service => {
                    diagram += generateServiceBlock(service);
                });
                diagram += '</div>';
                if (layers.database.length > 0 || layers.storage.length > 0) {
                    diagram += '<div class="connection-arrow"><i class="fas fa-arrow-down"></i></div>';
                }
            }
            
            // 데이터베이스 및 스토리지 레이어
            if (layers.database.length > 0 || layers.storage.length > 0) {
                diagram += '<div class="layer-label">데이터 레이어</div>';
                diagram += '<div class="service-layer">';
                layers.database.forEach(service => {
                    diagram += generateServiceBlock(service);
                });
                layers.storage.forEach(service => {
                    diagram += generateServiceBlock(service);
                });
                diagram += '</div>';
            }

            // Uncategorized 레이어
            if (layers.uncategorized.length > 0) {
                diagram += '<div class="layer-label">카테고리 지정이 아직 안된 서비스 (수정예정)</div>';
                diagram += '<div class="service-layer">';
                layers.uncategorized.forEach(service => {
                    diagram += generateServiceBlock(service);
                });
                diagram += '</div>';
            }
            
            diagram += '</div>';
            return diagram;
        }
        
        // 서비스 블록 생성 함수
        function generateServiceBlock(service) {
            const serviceName = service.name.replace('Amazon', '').replace('AWS', '');
            const icon = serviceIcons[serviceName] || 'fas fa-cube';
            const totalCost = service.total_monthly_cost || service.total_cost || 0;
            const unitCost = service.unit_monthly_cost || (totalCost / (service.quantity || 1));
            const quantity = service.quantity || 1;
            
            return `
                <div class="service-stack" onclick="showServiceReason('${serviceName}', '${service.reason.replace(/'/g, "\\'")}')">                    <div class="service-block main-block">
                        <div class="service-icon"><i class="${icon}"></i></div>
                        <div class="service-name">${serviceName}</div>
                        <div class="service-type">${service.type}</div>
                        <div class="service-cost">$${Math.round(unitCost)}/월</div>
                        ${quantity > 1 ? `<div class="service-quantity">x${quantity}</div>` : ''}
                    </div>
                    ${quantity > 1 ? '<div class="service-block shadow-block"></div>' : ''}
                    ${quantity > 2 ? '<div class="service-block shadow-block-2"></div>' : ''}
                </div>
            `;
        }
        
        // 서비스 이유 표시 함수
        function showServiceReason(serviceName, reason) {
            document.getElementById('serviceModalTitle').textContent = serviceName + ' 서비스';
            document.getElementById('serviceModalText').textContent = '추천 이유: ' + reason;
            document.getElementById('serviceModal').style.display = 'block';
        }
        
        // 서비스 모달 닫기
        function closeServiceModal() {
            document.getElementById('serviceModal').style.display = 'none';
        }
        
        // 페이지 로드 시 Free 요금제 기본 선택
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelector('.pricing-card.free').classList.add('selected');
        });
    </script>
</body>
</html>